jQuery(document).ready(function(e){var t=wc_ps_vars.legacy_api_url,i=(wc_ps_vars.permalink_structure,wc_ps_vars.search_page_url,wc_ps_vars.minChars),s=wc_ps_vars.delay,a={apps:{},models:{},collections:{},views:{}};_.templateSettings={evaluate:/\{\{(.+?)\}\}/g,interpolate:/\{\{=(.+?)\}\}/g,escape:/\{\{-(.+?)\}\}/g},a.models.Item=Backbone.Model.extend({defaults:{title:"Empty Product",keyword:"",url:null,image_url:null,sku:null,price:null,description:null,type:"product",status:!0}}),a.collections.Items=Backbone.Collection.extend({model:a.models.Item,totalItems:function(){return this.where({status:!0}).length},haveItems:function(e){return this.where({type:e}).length}}),a.views.Item=Backbone.View.extend({tagName:"li",className:function(){return"ac_odd"},itemTpl:_.template(e("#wc_psearch_itemTpl").html()),footerTpl:_.template(e("#wc_psearch_footerTpl").html()),initialize:function(){this.listenTo(this.model,"destroy",this.remove)},render:function(){switch(this.model.get("type")){case"header":this.$el.html('<div class="ajax_search_content_title">'+this.model.get("title")+"</div>");break;case"footer":this.$el.html(this.footerTpl(this.model.toJSON()));break;case"nothing":this.$el.html('<div class="ajax_no_result">'+this.model.get("title")+"</div>");break;default:this.$el.html(this.itemTpl(this.model.toJSON()))}return this}}),a.views.PopupResult=Backbone.View.extend({initialize:function(){this.predictive_search_input=null,this.original_ps_search_other="",this.listenTo(this.collection,"add",this.addItem),this.list_items_container=this.$(".predictive_search_results")},createItems:function(t){e.each(t,function(e,t){this.collection.add(t)}.bind(this)),""==this.original_ps_search_other&&(this.original_ps_search_other=e(this.predictive_search_input).data("ps-search_other")),""==this.original_ps_search_in&&(this.original_ps_search_in=e(this.predictive_search_input).data("ps-search_in")),ps_search_other=this.original_ps_search_other.split(","),ps_id=e(this.predictive_search_input).data("ps-id"),new_ps_search_other=[],new_ps_search_in="",e.each(ps_search_other,function(e,t){this.collection.haveItems(t)>0&&(new_ps_search_other.push(t),""==new_ps_search_in&&(new_ps_search_in=t))}.bind(this)),""!=new_ps_search_in&&(e(this.predictive_search_input).data("ps-search_in",new_ps_search_in),e("#fr_pp_search_widget_"+ps_id).find("input[name=search_in]").val(new_ps_search_in)),0==new_ps_search_other.length&&(new_ps_search_other=[e(this.predictive_search_input).data("ps-search_in")]),e(this.predictive_search_input).data("ps-search_other",new_ps_search_other.join(",")),e("#fr_pp_search_widget_"+ps_id).find("input[name=search_other]").val(new_ps_search_other.join(","))},addItem:function(t){var i=new a.views.Item({model:t}),s=i.render().el;this.list_items_container.append(s),e.data(s,"ac_data",t.attributes)},clearAll:function(){return _.invoke(this.collection.where({status:!0}),"destroy"),!1}}),a.apps.App={initialize:function(){e(document).on("click",".predictive_search_bt",this.goToSearchResultPage),e(".fr_search_widget").bind("keypress",function(e){return 13==e.keyCode?(this.goToSearchResultPage(e),!1):void 0}.bind(this)),this.initPredictSearch()},initPredictSearch:function(){e(".predictive_search_input").each(function(){e(this).autocomplete(t,{minChars:i,delay:s,scrollHeight:2e3,loadingClass:"predictive_loading",highlight:!1},a),e(this).result(function(t,i,s){""!=i&&e(this).val(i),""!=s&&null!=s&&"#"!=s&&(window.location=s)})})},goToSearchResultPage:function(t){var i=e(t.target);ps_id=i.data("ps-id"),predictive_search_input=e("#pp_course_"+ps_id),""!=predictive_search_input.val()&&predictive_search_input.val()!=predictive_search_input.data("ps-default_text")&&e("#fr_pp_search_widget_"+ps_id).submit()}};var r=a.apps.App;r.initialize()});